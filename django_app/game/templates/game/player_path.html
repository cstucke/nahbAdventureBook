{% extends 'game/base.html' %}

{% block content %}
<h2>// YOUR_JOURNEY_LOG //</h2>
<p class="system-msg">RECONSTRUCTING_TRAJECTORY...</p>
<div class="separator"></div>

<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true, theme: 'dark' });
</script>

<div class="mermaid" style="background: #000; padding: 20px;">
graph LR
    %% Styles
    classDef visited fill:#003300,stroke:#33ff33,stroke-width:2px,color:#33ff33;

    %% Define all visited nodes first
    {% for pid in path_ids %}
        P{{ pid }}[PAGE_{{ pid }}]
        class P{{ pid }} visited
    {% endfor %}

    %% Link them in a simple sequence
    {% for pid in path_ids %}
        {% if not forloop.last %}
            P{{ pid }} --> P{{ path_ids|slice:forloop.counter|first }}
        {% endif %}
    {% endfor %}
</div>

<div class="separator"></div>
<a href="{% url 'play_story' story.id %}">[ RETURN_TO_SYSTEM ]</a>
{% endblock %}